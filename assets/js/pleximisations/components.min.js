const plexObj={limit:4,current:0,orderQty:10,orderPPU:0,orderSetup:0,orderTotal:0,pleximisationFees:{}},pleximisationOptions={1:["Small Embroidery",0,0],2:["Medium Embroidery",0,0],3:["Large Embroidery",0,0],4:["XL Embroidery",0,0],5:["Screen Print 1 Colour",0,55],6:["Screen Print 2 Colours",0,110],7:["Screen Print 3 Colours",0,165],8:["Screen Print 4 Colour",0,220],9:["Small Full Colour Digital Print",0,75],10:["Medium Full Colour Digital Print",0,75],11:["Large Full Colour Digital Print",0,75],12:["XL Full Colour Digital Print",0,75],13:["2XL Full Colour Digital Print",0,75],14:["Undecorated",0,0]},generateRandomID=()=>`${Math.floor(10*Math.random())}${Math.floor(10*Math.random())}${Math.floor(10*Math.random())}`,addtoQuote=()=>{const quoteObject=plexObj,productObject={id:document.querySelector("#pleximisation-product-id").value,imageURL:document.querySelector("#pleximisation-product-image").value,brand:document.querySelector("#pleximisation-product-brand").value,brandURL:document.querySelector("#pleximisation-product-brand-url").value,title:document.querySelector("#pleximisation-product-title").value,sku:document.querySelector("#pleximisation-product-sku").value},toAddObject={"product-id":productObject.id,"product-image":productObject.imageURL,"product-brand":productObject.brand,"product-title":productObject.title,"product-sku":productObject.sku,"product-colour":productObject.colour,"product-size":productObject.size,"price-per-unit":quoteObject.pricePerUnit,"setup-fees":quoteObject.setupFees,quantity:quoteObject.quantity,total:quoteObject.total},cartItemID=`PXciID${generateRandomID()}`;sessionStorage.setItem(cartItemID,toAddObject)},removeFromQuote=()=>{},addPleximisation=()=>{if(!(plexObj.current<plexObj.limit))return!1;{plexObj.current++;const optionsWrapper=document.querySelector("#pleximisation-options"),innerDiv=document.createElement("div");innerDiv.classList.add("pleximisation-selections");const randomId=`PX${generateRandomID()}`;innerDiv.dataset.secretId=randomId,plexObj.pleximisationFees[randomId]=[0,0];const selectionBox=document.createElement("select");selectionBox.classList.add("pleximisation-box"),selectionBox.setAttribute("onchange","changePleximisation(this)");const topOption=document.createElement("option");topOption.setAttribute("selected",!0),topOption.setAttribute("disabled",!0),topOption.append(document.createTextNode("Select Customisation")),topOption.value=0,selectionBox.append(topOption);for(const item in Object.keys(pleximisationOptions))if(Object.keys(pleximisationOptions)[item]){const thisOption=document.createElement("option");thisOption.append(document.createTextNode(pleximisationOptions[Object.keys(pleximisationOptions)[item]][0])),thisOption.value=Object.keys(pleximisationOptions)[item],thisOption.dataset.index=Object.keys(pleximisationOptions)[item],selectionBox.append(thisOption)}const deleteOption=document.createElement("div");deleteOption.classList.add("pleximisation-delete"),deleteOption.setAttribute("onclick","removePleximisation(this)"),deleteOption.innerHTML='<i class="fa-solid fa-trash-can"></i>',innerDiv.append(selectionBox),innerDiv.append(deleteOption),optionsWrapper.append(innerDiv)}return plexObj.current===plexObj.limit&&(document.querySelector(".pleximisation-add").style.display="none"),!0},getCorrectPrice=(value,price)=>{const pricingObj={1:price,10:price,25:.9*price,50:.8*price,100:.75*price,250:.6*price};let moreThan=0;for(const item in Object.keys(pricingObj))value>=parseInt(Object.keys(pricingObj)[item],10)&&(moreThan=Object.keys(pricingObj)[item]);let extraPPU=0;for(const item in plexObj.pleximisationFees)plexObj.pleximisationFees[item]&&(extraPPU+=plexObj.pleximisationFees[item][0]);return parseFloat(pricingObj[moreThan]+extraPPU).toFixed(2)},getCorrectFees=()=>{let extraSetupFees=0;for(const item in plexObj.pleximisationFees)plexObj.pleximisationFees[item]&&(extraSetupFees+=plexObj.pleximisationFees[item][1]);return extraSetupFees},updateChargesBlock=()=>{const elQty=document.querySelector(".pleximisation-quantity .pleximisation-pricing-unit"),elIndividualPrice=document.querySelector(".pleximisation-individual-price .pleximisation-pricing-unit"),elSetupFees=document.querySelector(".pleximisation-setup-fee .pleximisation-pricing-unit"),elTotal=document.querySelector(".pleximisation-total-price .pleximisation-pricing-unit");elQty.innerHTML='<i class="fa-solid fa-spinner"></i>',elIndividualPrice.innerHTML='<i class="fa-solid fa-spinner"></i>',elSetupFees.innerHTML='<i class="fa-solid fa-spinner"></i>',elTotal.innerHTML='<i class="fa-solid fa-spinner"></i>',setTimeout(()=>{const qty=document.querySelector(".form-input.form-input--incrementTotal"),setPrice=parseFloat(document.querySelector("[data-product-price-without-tax]").innerHTML.replace("$","")).toFixed(2),unitPrice=getCorrectPrice(qty.value,setPrice),setupCost=getCorrectFees();plexObj.orderQty=parseInt(qty.value,10),plexObj.orderPPU=parseFloat(unitPrice).toFixed(2),plexObj.orderSetup=parseFloat(setupCost).toFixed(2),plexObj.orderTotal=parseFloat(qty.value*unitPrice+setupCost).toFixed(2),elQty.innerHTML=plexObj.orderQty,elIndividualPrice.innerHTML=`$${plexObj.orderPPU}`,elSetupFees.innerHTML=0===setupCost?"-":`$${plexObj.orderSetup}`,elTotal.innerHTML=`$${parseFloat(qty.value*unitPrice+setupCost).toFixed(2)}`},500)},removePleximisation=e=>{e.parentElement.parentElement.removeChild(e.parentElement),plexObj.current--;const idKey=e.parentElement.dataset.secretId;delete plexObj.pleximisationFees[idKey],plexObj.current<plexObj.limit&&(document.querySelector(".pleximisation-add").style.display="flex"),updateChargesBlock()},changePleximisation=e=>{const idKey=e.parentElement.dataset.secretId;plexObj.pleximisationFees[idKey][0]=pleximisationOptions[e.options[e.selectedIndex].dataset.index][1],plexObj.pleximisationFees[idKey][1]=pleximisationOptions[e.options[e.selectedIndex].dataset.index][2],updateChargesBlock()},loadPleximisations=()=>{addPleximisation()};window.addEventListener("load",()=>{const qty=document.querySelector(".form-input.form-input--incrementTotal");qty.value=10,loadPleximisations(),updateChargesBlock()}),document.querySelector(".form-input.form-input--incrementTotal").addEventListener("change",()=>{updateChargesBlock()}),document.querySelector("#addToQuoteBtn").addEventListener("click",()=>{addtoQuote()});for(let i=0;i<document.querySelectorAll(".form-increment .button.button--icon").length;i++)document.querySelectorAll(".form-increment .button.button--icon")[i].addEventListener("click",()=>{updateChargesBlock()});