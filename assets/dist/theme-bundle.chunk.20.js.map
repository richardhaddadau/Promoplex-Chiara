{"version":3,"sources":["webpack://WebpackChiara/./assets/js/chiara/dropdown-swatches.js"],"names":["product","swatchFieldSelector","getSwatchLabelFromInput","inputEl","$","next","children","first","attr","getSwatchImageHTMLFromInput","html","isSwatchHidden","is","isSwatchUnavailable","hasClass","renderSelect","$formField","$select","find","after","hideOriginalSwatches","hideOriginalSwatchesFunc","css","visibility","height","width","overflow","margin","disableSearchInput","$scope","not","addClass","get","map","el","forEach","$inputs","context","txtSelectOne","hide","on","event","preventDefault","stopPropagation","each","i","label","append","checked","selectize","copyClassesToDropdown","render","item","escape","$input","filter","value","text","option","onInitialize","this","$control_input","val","trigger","setValue","clearCache","clear","refreshOptions"],"mappings":"qHAAA,iCAGe,mBAAUA,EAAV,GAgBP,iBAAJ,GAAI,MAfJC,2BAeI,MAfkB,0FAelB,MAdJC,+BAcI,MAdsB,SAAAC,GAAO,OAAIC,EAAED,GAASE,OAAOC,WAAWC,QAAQC,KAAK,UAc3E,MAbJC,mCAaI,MAb0B,SAAAN,GAAO,OAAIC,EAAED,GAASE,OAAOK,QAavD,MAZJC,sBAYI,MAZa,SAAAR,GAAO,OAAIC,EAAED,GAASE,OAAOO,GAAG,YAY7C,MAXJC,2BAWI,MAXkB,SAAAV,GAAO,OAAIC,EAAED,GAASE,OAAOS,SAAS,gBAWxD,MAVJC,oBAUI,MAVW,SAACC,EAAYC,GAAb,OAAyBD,EAAWE,KAAK,eAAeX,QAAQY,MAAMF,IAUjF,MATJG,4BASI,aARJC,gCAQI,MARuB,SAAAL,GAAU,OAAIA,EAAWV,SAAS,uBAAuBgB,IAAI,CACpFC,WAAY,SACZC,OAAQ,EACRC,MAAO,EACPC,SAAU,SACVC,OAAQ,KAGR,MADJC,0BACI,SACJ5B,EAAQ6B,OAAOX,KAAKjB,GAAqB6B,IAAI,4BACxCC,SAAS,2BACTC,MACAC,KAAI,SAAAC,GAAE,OAAI9B,EAAE8B,MACZC,SAAQ,SAAAnB,GACL,IAAMoB,EAAUpB,EAAWE,KAAK,SAG1BD,EAAUb,EAAE,6DAA6DJ,EAAQqC,QAAQC,aAA9E,sBACZC,OACAC,GAAG,UAAU,SAAAC,GAEVA,EAAMC,iBACND,EAAME,qBAIdP,EAAQQ,MAAK,SAACC,EAAGX,GACb,IAAMY,EAAQ5C,EAAwBgC,GACtCjB,EAAQ8B,OAAR,kBAAiC3C,EAAE8B,GAAI1B,KAAK,SAA5C,YAAgEsC,EAAhE,MAA0EZ,EAAGc,QAAU,WAAa,IAApG,IAA0GF,EAA1G,gBAIJ/B,EAAaC,EAAYC,GAGrBG,GACAC,EAAyBL,GAI7BC,EAAQgC,UAAU,CACdC,uBAAuB,EACvBC,OAAQ,CACJC,KAAM,SAACA,EAAMC,GACT,IAAMC,EAASlB,EAAQmB,OAAR,WAA0BH,EAAKI,MAA/B,MACf,0DACwB3C,EAAoByC,GAAU,cAAgB,IADtE,MAC6E3C,EAAe2C,GAAU,uBAAyB,IAD/H,yDAE6B7C,EAA4B6C,GAFzD,gEAG8BD,EAAOD,EAAKK,MAH1C,yEAOJC,OAAQ,SAACN,EAAMC,GACX,IAAMC,EAASlB,EAAQmB,OAAR,WAA0BH,EAAKI,MAA/B,MACf,4DAC0B3C,EAAoByC,GAAU,cAAgB,IADxE,MAC+E3C,EAAe2C,GAAU,uBAAyB,IADjI,yDAE6B7C,EAA4B6C,GAFzD,gEAG8BD,EAAOD,EAAKK,MAH1C,0EAQRE,aAtBc,WAuBN/B,GACAgC,KAAKC,eAAerD,KAAK,YAAY,MAKjD,IAAMyC,EAAYhC,EAAQ,GAAGgC,UAG7BA,EAAUT,GAAG,UAAU,WAEnBJ,EAAQmB,OAAR,WAA0BtC,EAAQ6C,MAAlC,MAA6CC,QAAQ,YAIzD/D,EAAQ6B,OAAOX,KAAK,gCAAgCsB,GAAG,UAAU,WAE7D,IAAMgB,EAAQpB,EAAQmB,OAAO,YAAYO,MACzCb,EAAUe,SAASR,GAAO,MAI9BxD,EAAQ6B,OAAOtB,QAAQiC,GAAG,2BAA2B,WAEjD,IAAMgB,EAAQpB,EAAQmB,OAAO,YAAYO,MACzCb,EAAUgB,aACVhB,EAAUiB,OAAM,GAChBjB,EAAUe,SAASR,GAAO,GAC1BP,EAAUkB,gBAAe,W","file":"theme-bundle.chunk.20.js","sourcesContent":["import 'selectize';\nimport 'selectize-css'; // eslint-disable-line import/no-unresolved\n\nexport default function (product, {\n    swatchFieldSelector = 'form[data-cart-item-add] [data-product-option-change] [data-product-attribute=\"swatch\"]',\n    getSwatchLabelFromInput = inputEl => $(inputEl).next().children().first().attr('title'),\n    getSwatchImageHTMLFromInput = inputEl => $(inputEl).next().html(),\n    isSwatchHidden = inputEl => $(inputEl).next().is(':hidden'),\n    isSwatchUnavailable = inputEl => $(inputEl).next().hasClass('unavailable'),\n    renderSelect = ($formField, $select) => $formField.find('.form-label').first().after($select),\n    hideOriginalSwatches = false,\n    hideOriginalSwatchesFunc = $formField => $formField.children('.form-option-swatch').css({\n        visibility: 'hidden',\n        height: 0,\n        width: 0,\n        overflow: 'hidden',\n        margin: 0,\n    }),\n    disableSearchInput = false,\n} = {}) {\n    product.$scope.find(swatchFieldSelector).not('._dropdownSwatchesLoaded')\n        .addClass('_dropdownSwatchesLoaded')\n        .get()\n        .map(el => $(el))\n        .forEach($formField => {\n            const $inputs = $formField.find('input');\n\n            // Hidden select for initializing Selectize\n            const $select = $(`<select class=\"chiara__dropdownSwatches\"><option value=\"\">${product.context.txtSelectOne}</option></select>`)\n                .hide()\n                .on('change', event => {\n                    // Stop the form's change event\n                    event.preventDefault();\n                    event.stopPropagation();\n                });\n\n            // Populate the hidden select options\n            $inputs.each((i, el) => {\n                const label = getSwatchLabelFromInput(el);\n                $select.append(`<option value=\"${$(el).attr('value')}\" title=\"${label}\" ${el.checked ? 'selected' : ''}>${label}</option>`);\n            });\n\n            // Insert the hidden select to the form field\n            renderSelect($formField, $select);\n\n            // Hide the original swatches if specified\n            if (hideOriginalSwatches) {\n                hideOriginalSwatchesFunc($formField);\n            }\n\n            // Initialize 'Selectize' select box\n            $select.selectize({\n                copyClassesToDropdown: true,\n                render: {\n                    item: (item, escape) => {\n                        const $input = $inputs.filter(`[value=\"${item.value}\"]`);\n                        return `\n                            <div class=\"_item ${isSwatchUnavailable($input) ? 'unavailable' : ''}\" ${isSwatchHidden($input) ? 'style=\"display:none\"' : ''}>\n                                <span class=\"_img\">${getSwatchImageHTMLFromInput($input)}</span>\n                                <span class=\"_text\">${escape(item.text)}</span>\n                            </div>\n                        `;\n                    },\n                    option: (item, escape) => {\n                        const $input = $inputs.filter(`[value=\"${item.value}\"]`);\n                        return `\n                            <div class=\"_option ${isSwatchUnavailable($input) ? 'unavailable' : ''}\" ${isSwatchHidden($input) ? 'style=\"display:none\"' : ''}>\n                                <span class=\"_img\">${getSwatchImageHTMLFromInput($input)}</span>\n                                <span class=\"_text\">${escape(item.text)}</span>\n                            </div>\n                        `;\n                    },\n                },\n                onInitialize() {\n                    if (disableSearchInput) {\n                        this.$control_input.attr('readonly', true);\n                    }\n                },\n            });\n\n            const selectize = $select[0].selectize;\n\n            // Select the original swatch when the dropdown swatch selected\n            selectize.on('change', () => {\n                // console.log('selectize change');\n                $inputs.filter(`[value=\"${$select.val()}\"]`).trigger('click');\n            });\n\n            // Select the dropdown swatch when the original swatch selected\n            product.$scope.find('[data-product-option-change]').on('change', () => {\n                // console.log('data-product-option-change change');\n                const value = $inputs.filter(':checked').val();\n                selectize.setValue(value, true);\n            });\n\n            // Update 'Selectize' options when the availablity of the original swatches changed\n            product.$scope.first().on('updateProductAttributes', () => {\n                // console.log('updateProductAttributes');\n                const value = $inputs.filter(':checked').val();\n                selectize.clearCache();\n                selectize.clear(true);\n                selectize.setValue(value, true);\n                selectize.refreshOptions(false);\n            });\n        });\n}\n"],"sourceRoot":""}